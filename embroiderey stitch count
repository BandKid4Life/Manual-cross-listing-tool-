import tkinter as tk
from tkinter import filedialog, messagebox
from pyembroidery import read_dst  # read_dst auto-detects file type, including DSB

def open_file():
    file_path = filedialog.askopenfilename(
        title="Select Embroidery File",
        filetypes=[("Embroidery Files", "*.dst *.dsb")]
    )
    if not file_path:
        return

    try:
        # pyembroidery auto-detects .dst, .dsb, etc.
        pattern = read_dst(file_path)
        stitch_count = pattern.count_stitches()
        result_label.config(text=f"ðŸ§µ Stitch Count: {stitch_count:,}")
    except Exception as e:
        messagebox.showerror("Error", f"Failed to read file:\n{e}")

# --- GUI setup ---
root = tk.Tk()
root.title("Embroidery Stitch Counter")
root.geometry("400x250")
root.configure(bg="#1e1e1e")

title_label = tk.Label(root, text="Embroidery Stitch Counter", font=("Segoe UI", 16, "bold"), fg="white", bg="#1e1e1e")
title_label.pack(pady=20)

open_button = tk.Button(root, text="Select File", font=("Segoe UI", 12), command=open_file, bg="#3a3a3a", fg="white", relief="flat", padx=15, pady=8)
open_button.pack(pady=10)

result_label = tk.Label(root, text="No file selected", font=("Segoe UI", 12), fg="#bbbbbb", bg="#1e1e1e")
result_label.pack(pady=20)

footer = tk.Label(root, text="Supported formats: DST, DSB", font=("Segoe UI", 9), fg="#777777", bg="#1e1e1e")
footer.pack(side="bottom", pady=10)

root.mainloop()
